<!-- Code generated by gomarkdoc. DO NOT EDIT -->

# server

```go
import "github.com/alimasry/go-collab-editor/server"
```

## Index

- [Constants](<#constants>)
- [func NewHandler\(hub \*Hub\) http.Handler](<#NewHandler>)
- [type Client](<#Client>)
  - [func \(c \*Client\) Info\(\) ClientInfo](<#Client.Info>)
  - [func \(c \*Client\) ReadPump\(\)](<#Client.ReadPump>)
  - [func \(c \*Client\) WritePump\(\)](<#Client.WritePump>)
- [type ClientInfo](<#ClientInfo>)
- [type ClientMessage](<#ClientMessage>)
- [type Hub](<#Hub>)
  - [func NewHub\(st store.DocumentStore, engine ot.Engine\) \*Hub](<#NewHub>)
  - [func \(h \*Hub\) GetSession\(docID string\) \*Session](<#Hub.GetSession>)
  - [func \(h \*Hub\) Run\(\)](<#Hub.Run>)
- [type ServerMessage](<#ServerMessage>)
  - [func \(m ServerMessage\) Encode\(\) \[\]byte](<#ServerMessage.Encode>)
- [type Session](<#Session>)
  - [func \(s \*Session\) Run\(\)](<#Session.Run>)


## Constants

<a name="MsgJoin"></a>Message types exchanged over WebSocket.

```go
const (
    MsgJoin  = "join"
    MsgLeave = "leave"
    MsgOp    = "op"
    MsgAck   = "ack"
    MsgDoc   = "doc"
    MsgError = "error"
)
```

<a name="NewHandler"></a>
## func NewHandler

```go
func NewHandler(hub *Hub) http.Handler
```

NewHandler creates the HTTP handler with all routes.

<a name="Client"></a>
## type Client

Client represents a single WebSocket connection.

```go
type Client struct {
    ID    string
    Name  string
    Color string
    // contains filtered or unexported fields
}
```

<a name="Client.Info"></a>
### func \(\*Client\) Info

```go
func (c *Client) Info() ClientInfo
```



<a name="Client.ReadPump"></a>
### func \(\*Client\) ReadPump

```go
func (c *Client) ReadPump()
```

ReadPump reads messages from the WebSocket and routes them.

<a name="Client.WritePump"></a>
### func \(\*Client\) WritePump

```go
func (c *Client) WritePump()
```

WritePump writes messages from the send channel to the WebSocket.

<a name="ClientInfo"></a>
## type ClientInfo

ClientInfo describes a connected user.

```go
type ClientInfo struct {
    ID    string `json:"id"`
    Name  string `json:"name"`
    Color string `json:"color"`
}
```

<a name="ClientMessage"></a>
## type ClientMessage

ClientMessage is a message from client to server.

```go
type ClientMessage struct {
    Type     string       `json:"type"`
    DocID    string       `json:"docId,omitempty"`
    Revision int          `json:"revision"`
    Op       ot.Operation `json:"op,omitempty"`
}
```

<a name="Hub"></a>
## type Hub

Hub manages document sessions and routes clients to the right session.

```go
type Hub struct {
    // contains filtered or unexported fields
}
```

<a name="NewHub"></a>
### func NewHub

```go
func NewHub(st store.DocumentStore, engine ot.Engine) *Hub
```



<a name="Hub.GetSession"></a>
### func \(\*Hub\) GetSession

```go
func (h *Hub) GetSession(docID string) *Session
```

GetSession returns the session for a document, if active.

<a name="Hub.Run"></a>
### func \(\*Hub\) Run

```go
func (h *Hub) Run()
```

Run is the hub's main loop.

<a name="ServerMessage"></a>
## type ServerMessage

ServerMessage is a message from server to client.

```go
type ServerMessage struct {
    Type     string       `json:"type"`
    DocID    string       `json:"docId,omitempty"`
    Content  string       `json:"content"`
    Revision int          `json:"revision"`
    Op       ot.Operation `json:"op,omitempty"`
    ClientID string       `json:"clientId,omitempty"`
    Name     string       `json:"name,omitempty"`
    Color    string       `json:"color,omitempty"`
    Message  string       `json:"message,omitempty"`
    Clients  []ClientInfo `json:"clients,omitempty"`
}
```

<a name="ServerMessage.Encode"></a>
### func \(ServerMessage\) Encode

```go
func (m ServerMessage) Encode() []byte
```

Encode serializes a ServerMessage to JSON bytes.

<a name="Session"></a>
## type Session

Session manages collaboration for a single document. All operations are serialized through a single goroutine.

```go
type Session struct {
    // contains filtered or unexported fields
}
```

<a name="Session.Run"></a>
### func \(\*Session\) Run

```go
func (s *Session) Run()
```

Run is the session's main loop. It serializes all operations.

Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)
