<!-- Code generated by gomarkdoc. DO NOT EDIT -->

# store

```go
import "github.com/alimasry/go-collab-editor/store"
```

## Index

- [type CachedStore](<#CachedStore>)
  - [func NewCachedStore\(backing DocumentStore, flushInterval time.Duration\) \*CachedStore](<#NewCachedStore>)
  - [func \(cs \*CachedStore\) AppendOperation\(ctx context.Context, id string, op ot.Operation, version int\) error](<#CachedStore.AppendOperation>)
  - [func \(cs \*CachedStore\) Close\(\)](<#CachedStore.Close>)
  - [func \(cs \*CachedStore\) Create\(ctx context.Context, id, content string\) error](<#CachedStore.Create>)
  - [func \(cs \*CachedStore\) Get\(ctx context.Context, id string\) \(\*DocumentInfo, error\)](<#CachedStore.Get>)
  - [func \(cs \*CachedStore\) GetOperations\(ctx context.Context, id string, fromVersion int\) \(\[\]ot.Operation, error\)](<#CachedStore.GetOperations>)
  - [func \(cs \*CachedStore\) List\(ctx context.Context\) \(\[\]DocumentInfo, error\)](<#CachedStore.List>)
  - [func \(cs \*CachedStore\) UpdateContent\(ctx context.Context, id, content string, version int\) error](<#CachedStore.UpdateContent>)
- [type DocumentInfo](<#DocumentInfo>)
- [type DocumentStore](<#DocumentStore>)
- [type FirestoreStore](<#FirestoreStore>)
  - [func NewFirestoreStore\(client \*firestore.Client\) \*FirestoreStore](<#NewFirestoreStore>)
  - [func \(s \*FirestoreStore\) AppendOperation\(ctx context.Context, id string, op ot.Operation, version int\) error](<#FirestoreStore.AppendOperation>)
  - [func \(s \*FirestoreStore\) Create\(ctx context.Context, id, content string\) error](<#FirestoreStore.Create>)
  - [func \(s \*FirestoreStore\) Get\(ctx context.Context, id string\) \(\*DocumentInfo, error\)](<#FirestoreStore.Get>)
  - [func \(s \*FirestoreStore\) GetOperations\(ctx context.Context, id string, fromVersion int\) \(\[\]ot.Operation, error\)](<#FirestoreStore.GetOperations>)
  - [func \(s \*FirestoreStore\) List\(ctx context.Context\) \(\[\]DocumentInfo, error\)](<#FirestoreStore.List>)
  - [func \(s \*FirestoreStore\) UpdateContent\(ctx context.Context, id, content string, version int\) error](<#FirestoreStore.UpdateContent>)
- [type MemoryStore](<#MemoryStore>)
  - [func NewMemoryStore\(\) \*MemoryStore](<#NewMemoryStore>)
  - [func \(s \*MemoryStore\) AppendOperation\(\_ context.Context, id string, op ot.Operation, version int\) error](<#MemoryStore.AppendOperation>)
  - [func \(s \*MemoryStore\) Create\(\_ context.Context, id, content string\) error](<#MemoryStore.Create>)
  - [func \(s \*MemoryStore\) Get\(\_ context.Context, id string\) \(\*DocumentInfo, error\)](<#MemoryStore.Get>)
  - [func \(s \*MemoryStore\) GetOperations\(\_ context.Context, id string, fromVersion int\) \(\[\]ot.Operation, error\)](<#MemoryStore.GetOperations>)
  - [func \(s \*MemoryStore\) List\(\_ context.Context\) \(\[\]DocumentInfo, error\)](<#MemoryStore.List>)
  - [func \(s \*MemoryStore\) UpdateContent\(\_ context.Context, id, content string, version int\) error](<#MemoryStore.UpdateContent>)


<a name="CachedStore"></a>
## type CachedStore

CachedStore wraps a backing DocumentStore with an in\-memory cache. All reads and writes are served from the cache. Dirty documents are flushed to the backing store periodically in the background.

```go
type CachedStore struct {
    // contains filtered or unexported fields
}
```

<a name="NewCachedStore"></a>
### func NewCachedStore

```go
func NewCachedStore(backing DocumentStore, flushInterval time.Duration) *CachedStore
```

NewCachedStore creates a CachedStore that caches in memory and flushes dirty documents to the backing store every flushInterval.

<a name="CachedStore.AppendOperation"></a>
### func \(\*CachedStore\) AppendOperation

```go
func (cs *CachedStore) AppendOperation(ctx context.Context, id string, op ot.Operation, version int) error
```



<a name="CachedStore.Close"></a>
### func \(\*CachedStore\) Close

```go
func (cs *CachedStore) Close()
```

Close signals the flush loop to perform a final flush and waits for it to complete.

<a name="CachedStore.Create"></a>
### func \(\*CachedStore\) Create

```go
func (cs *CachedStore) Create(ctx context.Context, id, content string) error
```



<a name="CachedStore.Get"></a>
### func \(\*CachedStore\) Get

```go
func (cs *CachedStore) Get(ctx context.Context, id string) (*DocumentInfo, error)
```



<a name="CachedStore.GetOperations"></a>
### func \(\*CachedStore\) GetOperations

```go
func (cs *CachedStore) GetOperations(ctx context.Context, id string, fromVersion int) ([]ot.Operation, error)
```



<a name="CachedStore.List"></a>
### func \(\*CachedStore\) List

```go
func (cs *CachedStore) List(ctx context.Context) ([]DocumentInfo, error)
```



<a name="CachedStore.UpdateContent"></a>
### func \(\*CachedStore\) UpdateContent

```go
func (cs *CachedStore) UpdateContent(ctx context.Context, id, content string, version int) error
```



<a name="DocumentInfo"></a>
## type DocumentInfo

DocumentInfo holds document metadata and content.

```go
type DocumentInfo struct {
    ID        string
    Content   string
    Version   int
    CreatedAt time.Time
    UpdatedAt time.Time
}
```

<a name="DocumentStore"></a>
## type DocumentStore

DocumentStore abstracts document persistence. Implementations: MemoryStore \(in\-memory\), FirestoreStore \(Google Cloud Firestore\).

```go
type DocumentStore interface {
    Create(ctx context.Context, id, content string) error
    Get(ctx context.Context, id string) (*DocumentInfo, error)
    List(ctx context.Context) ([]DocumentInfo, error)
    UpdateContent(ctx context.Context, id, content string, version int) error
    AppendOperation(ctx context.Context, id string, op ot.Operation, version int) error
    GetOperations(ctx context.Context, id string, fromVersion int) ([]ot.Operation, error)
}
```

<a name="FirestoreStore"></a>
## type FirestoreStore

FirestoreStore is a Firestore\-backed implementation of DocumentStore.

```go
type FirestoreStore struct {
    // contains filtered or unexported fields
}
```

<a name="NewFirestoreStore"></a>
### func NewFirestoreStore

```go
func NewFirestoreStore(client *firestore.Client) *FirestoreStore
```

NewFirestoreStore creates a new FirestoreStore using the given Firestore client.

<a name="FirestoreStore.AppendOperation"></a>
### func \(\*FirestoreStore\) AppendOperation

```go
func (s *FirestoreStore) AppendOperation(ctx context.Context, id string, op ot.Operation, version int) error
```



<a name="FirestoreStore.Create"></a>
### func \(\*FirestoreStore\) Create

```go
func (s *FirestoreStore) Create(ctx context.Context, id, content string) error
```



<a name="FirestoreStore.Get"></a>
### func \(\*FirestoreStore\) Get

```go
func (s *FirestoreStore) Get(ctx context.Context, id string) (*DocumentInfo, error)
```



<a name="FirestoreStore.GetOperations"></a>
### func \(\*FirestoreStore\) GetOperations

```go
func (s *FirestoreStore) GetOperations(ctx context.Context, id string, fromVersion int) ([]ot.Operation, error)
```



<a name="FirestoreStore.List"></a>
### func \(\*FirestoreStore\) List

```go
func (s *FirestoreStore) List(ctx context.Context) ([]DocumentInfo, error)
```



<a name="FirestoreStore.UpdateContent"></a>
### func \(\*FirestoreStore\) UpdateContent

```go
func (s *FirestoreStore) UpdateContent(ctx context.Context, id, content string, version int) error
```



<a name="MemoryStore"></a>
## type MemoryStore

MemoryStore is an in\-memory implementation of DocumentStore.

```go
type MemoryStore struct {
    // contains filtered or unexported fields
}
```

<a name="NewMemoryStore"></a>
### func NewMemoryStore

```go
func NewMemoryStore() *MemoryStore
```



<a name="MemoryStore.AppendOperation"></a>
### func \(\*MemoryStore\) AppendOperation

```go
func (s *MemoryStore) AppendOperation(_ context.Context, id string, op ot.Operation, version int) error
```



<a name="MemoryStore.Create"></a>
### func \(\*MemoryStore\) Create

```go
func (s *MemoryStore) Create(_ context.Context, id, content string) error
```



<a name="MemoryStore.Get"></a>
### func \(\*MemoryStore\) Get

```go
func (s *MemoryStore) Get(_ context.Context, id string) (*DocumentInfo, error)
```



<a name="MemoryStore.GetOperations"></a>
### func \(\*MemoryStore\) GetOperations

```go
func (s *MemoryStore) GetOperations(_ context.Context, id string, fromVersion int) ([]ot.Operation, error)
```



<a name="MemoryStore.List"></a>
### func \(\*MemoryStore\) List

```go
func (s *MemoryStore) List(_ context.Context) ([]DocumentInfo, error)
```



<a name="MemoryStore.UpdateContent"></a>
### func \(\*MemoryStore\) UpdateContent

```go
func (s *MemoryStore) UpdateContent(_ context.Context, id, content string, version int) error
```



Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)
