<!-- Code generated by gomarkdoc. DO NOT EDIT -->

# ot

```go
import "github.com/alimasry/go-collab-editor/ot"
```

## Index

- [func Apply\(doc string, op Operation\) \(string, error\)](<#Apply>)
- [type Component](<#Component>)
  - [func \(c Component\) IsDelete\(\) bool](<#Component.IsDelete>)
  - [func \(c Component\) IsInsert\(\) bool](<#Component.IsInsert>)
  - [func \(c Component\) IsRetain\(\) bool](<#Component.IsRetain>)
- [type Document](<#Document>)
  - [func NewDocument\(content string\) \*Document](<#NewDocument>)
  - [func \(d \*Document\) Apply\(op Operation\) error](<#Document.Apply>)
- [type Engine](<#Engine>)
- [type JupiterEngine](<#JupiterEngine>)
  - [func \(e \*JupiterEngine\) TransformIncoming\(op Operation, revision int, history \[\]Operation\) \(Operation, error\)](<#JupiterEngine.TransformIncoming>)
- [type Operation](<#Operation>)
  - [func NewDelete\(pos, count, docLen int\) Operation](<#NewDelete>)
  - [func NewInsert\(pos int, text string, docLen int\) Operation](<#NewInsert>)
  - [func Transform\(a, b Operation\) \(aPrime, bPrime Operation, err error\)](<#Transform>)
  - [func \(op Operation\) BaseLen\(\) int](<#Operation.BaseLen>)
  - [func \(op Operation\) IsNoop\(\) bool](<#Operation.IsNoop>)
  - [func \(op Operation\) TargetLen\(\) int](<#Operation.TargetLen>)


<a name="Apply"></a>
## func Apply

```go
func Apply(doc string, op Operation) (string, error)
```

Apply applies the operation to a document string.

<a name="Component"></a>
## type Component

Component is a single step in an OT operation. Exactly one field should be set.

```go
type Component struct {
    Retain int    `json:"retain,omitempty"` // keep N chars unchanged
    Insert string `json:"insert,omitempty"` // insert text at cursor
    Delete int    `json:"delete,omitempty"` // remove N chars at cursor
}
```

<a name="Component.IsDelete"></a>
### func \(Component\) IsDelete

```go
func (c Component) IsDelete() bool
```



<a name="Component.IsInsert"></a>
### func \(Component\) IsInsert

```go
func (c Component) IsInsert() bool
```



<a name="Component.IsRetain"></a>
### func \(Component\) IsRetain

```go
func (c Component) IsRetain() bool
```



<a name="Document"></a>
## type Document

Document represents a collaborative document with its full operation history.

```go
type Document struct {
    Content string
    Version int
    History []Operation
}
```

<a name="NewDocument"></a>
### func NewDocument

```go
func NewDocument(content string) *Document
```

NewDocument creates a new document with the given initial content.

<a name="Document.Apply"></a>
### func \(\*Document\) Apply

```go
func (d *Document) Apply(op Operation) error
```

Apply applies an operation to the document, appending it to history.

<a name="Engine"></a>
## type Engine

Engine abstracts the OT collaboration algorithm. Different algorithms \(Jupiter, Wave, etc.\) implement this interface.

```go
type Engine interface {
    // TransformIncoming transforms a client operation (created at the given
    // revision) against all operations in the history since that revision.
    // Returns the operation transformed to apply at the current server state.
    TransformIncoming(op Operation, revision int, history []Operation) (Operation, error)
}
```

<a name="JupiterEngine"></a>
## type JupiterEngine

JupiterEngine implements the Jupiter OT algorithm. It sequentially transforms the incoming operation against each server operation the client hasn't seen.

```go
type JupiterEngine struct{}
```

<a name="JupiterEngine.TransformIncoming"></a>
### func \(\*JupiterEngine\) TransformIncoming

```go
func (e *JupiterEngine) TransformIncoming(op Operation, revision int, history []Operation) (Operation, error)
```



<a name="Operation"></a>
## type Operation

Operation is a sequence of components that transforms a document. Components are applied left\-to\-right, advancing a cursor through the input.

```go
type Operation struct {
    Ops []Component `json:"ops"`
}
```

<a name="NewDelete"></a>
### func NewDelete

```go
func NewDelete(pos, count, docLen int) Operation
```

NewDelete creates an operation that deletes count chars at pos in a document of docLen.

<a name="NewInsert"></a>
### func NewInsert

```go
func NewInsert(pos int, text string, docLen int) Operation
```

NewInsert creates an operation that inserts text at pos in a document of docLen.

<a name="Transform"></a>
### func Transform

```go
func Transform(a, b Operation) (aPrime, bPrime Operation, err error)
```

Transform takes two concurrent operations a and b \(both applied to the same document state\) and returns aPrime and bPrime such that:

```
Apply(Apply(doc, a), bPrime) == Apply(Apply(doc, b), aPrime)
```

<a name="Operation.BaseLen"></a>
### func \(Operation\) BaseLen

```go
func (op Operation) BaseLen() int
```

BaseLen returns the expected input document length.

<a name="Operation.IsNoop"></a>
### func \(Operation\) IsNoop

```go
func (op Operation) IsNoop() bool
```

IsNoop returns true if the operation makes no changes.

<a name="Operation.TargetLen"></a>
### func \(Operation\) TargetLen

```go
func (op Operation) TargetLen() int
```

TargetLen returns the document length after the operation is applied.

Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)
